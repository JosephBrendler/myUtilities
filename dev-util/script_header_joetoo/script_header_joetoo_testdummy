#!/bin/sh
####!/bin/bash   ### switched so it's also valid in busybox (ash) shell
#   script header with basic functions
# Author: joe brendler 19 Jul 2014
#         24 June 2025 - v1.0.0 moved to /usr/sbin/ and consolidated as script_header_joetoo
#
toc() # table of contents (this fn just calls summarize_header
{ # call summarize_header
summarize_header; printf "\n"
message "That's all I have to say about that"
}

#-----[ metadata tagging key ]------------------------------------------------
# @note this is a test line intended to wrap describes the usage syntax, options, and arguments for a function
# @note lines below starting '#' followed by ' @xxx' are interpreted by summarize_header as metadata
# @usage @usage describes the usage syntax, options, and arguments for a function
# @args @args defines positional parameters ($1, $2, etc) and their roles
# @vars @vars identifies global variables required or modified by the function
# @deps @deps lists function, script, or package dependencies
# @req @req specifies prerequisites or state requirements (e.g., must be root)
# @rule @rule outlines logic constraints or mandatory behaviors
# @note @note provides administrative or general notes for the user or maintainer
# @warn @warn provides administrative warning for user or maintainer

#-----[ Define common variables ]---------------------------------------------
BUILD="0.0.0 (19620207)"  #redefine in base script
ROOT_UID=0       # Only users with $UID 0 have root privileges
#script_header_installed_dir="/usr/sbin"
#script_header_installed_dir=/home/joe/myUtilities/dev-util/script_header_joetoo
script_header_installed_dir=/home/joe/myUtilities/dev-util/script_header_joetoo/testing

#---[ Simple Cursor State Control ]-----------------------------------
SCP()    # (ANSI) save the current cursor position
{ printf "%b" "${CSI}s" ; return $?; }
RCP()    # (ANSI) restore the cursor to the saved position
{ printf "%b" "${CSI}u" ; return $?; }
HCU()    # (ANSI) Hide the cursor (Note: the trailing character is lowercase L)
{ printf "%b" "${CSI}?25l" ; return $?; }
# ---[ common function blocks ]------------------------------------------

isnumber()          # (POSIX) deprecated - use isint(); tests if $1 is an integer
{ [ $# -eq 0 ] && return 1  # guard clause: check if an argument was provided
  _val=$1
  _test_val="${_val#-}"  # Remove leading dash (negative # ok; test the rest)
  case "$_test_val" in
    "" | *[!0-9]* ) unset -v _val _test_val; return 1 ;;
    *        ) unset -v _val _test_val; return 0 ;;
  esac ; }


W_message()   # (POSIX) display text warning message $@
{ printf " ${BYon}*${Boff} " ; printf "$@\n" ; }

E_message()   # (POSIX) display text error message $@
{ printf " ${BRon}*${Boff} " ; printf "$@\n" ; }

E_message_n()       # (POSIX) display text error message $@ (no CR)
{ printf " ${BRon}*${Boff} " ; printf "$@" ; }

_d_build_and_print() # Internal helper: Not for direct use.
{ # $1 = printf format string; $2...$n = message words and level
  # (level is compare to global verbosity by calling function but ignored by -lt test below)
  _fmt="$1"; shift
  # Use a subshell to avoid changing the original positional parameters ($@)
  ( _msg=""; _i=0; _word_count=$(( $# - 1 ))
    while [ "$_i" -lt "$_word_count" ]; do  # -lt excludes last element (level)
      _msg="${_msg}${_msg:+ }$1"; shift; _i=$((_i + 1)) # ${_msg:+ } is a space if _msg is set; nothing if unset
    done
    printf "$_fmt" "$_msg"
  )
}

